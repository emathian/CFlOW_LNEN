LR schedule: [12, 18, 22]
Number of pool layers = 3
CNF coder: 512
CNF coder: 1024
CNF coder: 2048
img_types   1
img_types   6
train/test loader length 280 117
train/test loader batches 8 4
Len train loader =  8
Epoch: 0 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/0/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_0_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_0_0.pt
Epoch: 0.0 	 train loss: 0.3807, lr=0.000097
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 0 	 step: 0.0000 
Epoch: 0 	 test_loss: 681.6874 and 5.89 fps
DET_AUROC: 	 last: 99.64 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9963884430176564
 SEG_AUROC   0.986054023521556
SEG_AUROC: 	 last: 98.61 	 max: 98.61 	 epoch_max: 0
Function: save_weights - Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_2022-10-03-10:40:36.pt
Len train loader =  8
Epoch: 1 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/1/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_1_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_1_0.pt
Epoch: 1.0 	 train loss: 0.2558, lr=0.000186
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 1 	 step: 0.0000 
Epoch: 1 	 test_loss: 1113.3554 and 5.91 fps
DET_AUROC: 	 last: 99.44 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9943820224719101
 SEG_AUROC   0.9886683173606745
SEG_AUROC: 	 last: 98.87 	 max: 98.87 	 epoch_max: 1
Function: save_weights - Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_2022-10-03-10:40:36.pt
Len train loader =  8
Epoch: 2 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/2/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_2_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_2_0.pt
Epoch: 2.0 	 train loss: 0.2352, lr=0.000197
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 2 	 step: 0.0000 
Epoch: 2 	 test_loss: 1.9710 and 5.87 fps
DET_AUROC: 	 last: 98.60 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9859550561797752
 SEG_AUROC   0.9898716447250172
SEG_AUROC: 	 last: 98.99 	 max: 98.99 	 epoch_max: 2
Function: save_weights - Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_2022-10-03-10:40:36.pt
Len train loader =  8
Epoch: 3 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/3/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_3_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_3_0.pt
Epoch: 3.0 	 train loss: 0.1892, lr=0.000193
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 3 	 step: 0.0000 
Epoch: 3 	 test_loss: 2.1897 and 6.99 fps
DET_AUROC: 	 last: 97.75 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9775280898876404
 SEG_AUROC   0.986716030837476
SEG_AUROC: 	 last: 98.67 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 4 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/4/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_4_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_4_0.pt
Epoch: 4.0 	 train loss: 0.1724, lr=0.000188
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 4 	 step: 0.0000 
Epoch: 4 	 test_loss: 8.5140 and 6.86 fps
DET_AUROC: 	 last: 97.95 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9795345104333868
 SEG_AUROC   0.9862144298275509
SEG_AUROC: 	 last: 98.62 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 5 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/5/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_5_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_5_0.pt
Epoch: 5.0 	 train loss: 0.1597, lr=0.000181
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 5 	 step: 0.0000 
Epoch: 5 	 test_loss: 13.3314 and 5.96 fps
DET_AUROC: 	 last: 98.11 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9811396468699839
 SEG_AUROC   0.9853194711652807
SEG_AUROC: 	 last: 98.53 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 6 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/6/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_6_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_6_0.pt
Epoch: 6.0 	 train loss: 0.1528, lr=0.000173
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 6 	 step: 0.0000 
Epoch: 6 	 test_loss: 21.2730 and 5.91 fps
DET_AUROC: 	 last: 98.35 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9835473515248796
 SEG_AUROC   0.98613204341796
SEG_AUROC: 	 last: 98.61 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 7 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/7/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_7_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_7_0.pt
Epoch: 7.0 	 train loss: 0.1470, lr=0.000164
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 7 	 step: 0.0000 
Epoch: 7 	 test_loss: 40.3655 and 5.94 fps
DET_AUROC: 	 last: 98.03 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9803370786516854
 SEG_AUROC   0.9895160051357295
SEG_AUROC: 	 last: 98.95 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 8 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/8/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_8_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_8_0.pt
Epoch: 8.0 	 train loss: 0.1399, lr=0.000154
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 8 	 step: 0.0000 
Epoch: 8 	 test_loss: 46.4881 and 5.93 fps
DET_AUROC: 	 last: 97.59 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9759229534510432
 SEG_AUROC   0.9880820225783546
SEG_AUROC: 	 last: 98.81 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 9 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/9/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_9_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_9_0.pt
Epoch: 9.0 	 train loss: 0.1348, lr=0.000143
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 9 	 step: 0.0000 
Epoch: 9 	 test_loss: 46.7057 and 5.42 fps
DET_AUROC: 	 last: 97.15 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9715088282504013
 SEG_AUROC   0.9871540092827912
SEG_AUROC: 	 last: 98.72 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 10 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/10/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_10_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_10_0.pt
Epoch: 10.0 	 train loss: 0.1287, lr=0.000131
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 10 	 step: 0.0000 
Epoch: 10 	 test_loss: 47.0356 and 6.63 fps
DET_AUROC: 	 last: 97.63 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9763242375601925
 SEG_AUROC   0.9881260075477838
SEG_AUROC: 	 last: 98.81 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 11 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/11/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_11_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_11_0.pt
Epoch: 11.0 	 train loss: 0.1254, lr=0.000119
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 11 	 step: 0.0000 
Epoch: 11 	 test_loss: 49.3946 and 6.86 fps
DET_AUROC: 	 last: 97.47 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9747191011235954
 SEG_AUROC   0.9888890679955546
SEG_AUROC: 	 last: 98.89 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 12 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/12/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_12_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_12_0.pt
Epoch: 12.0 	 train loss: 0.1223, lr=0.000106
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 12 	 step: 0.0000 
Epoch: 12 	 test_loss: 90.0502 and 5.89 fps
DET_AUROC: 	 last: 97.27 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9727126805778491
 SEG_AUROC   0.9893307897506352
SEG_AUROC: 	 last: 98.93 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 13 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/13/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_13_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_13_0.pt
Epoch: 13.0 	 train loss: 0.1182, lr=0.000094
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 13 	 step: 0.0000 
Epoch: 13 	 test_loss: 80.9297 and 5.89 fps
DET_AUROC: 	 last: 97.07 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9707062600321027
 SEG_AUROC   0.9893863887388538
SEG_AUROC: 	 last: 98.94 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 14 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/14/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_14_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_14_0.pt
Epoch: 14.0 	 train loss: 0.1157, lr=0.000081
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 14 	 step: 0.0000 
Epoch: 14 	 test_loss: 85.7097 and 5.93 fps
DET_AUROC: 	 last: 97.55 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.975521669341894
 SEG_AUROC   0.9875905026363297
SEG_AUROC: 	 last: 98.76 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 15 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
Path :  /gpfsscratch/rech/ohv/ueu39kt/CFLOW/weights/carpet_not_parallel_0310/carpet/15/mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_15_0.pt
Saving weights to mvtec_wide_resnet50_2_freia-cflow_pl3_cb8_inp512_run0_carpet_15_0.pt
Epoch: 15.0 	 train loss: 0.1126, lr=0.000069
Len test_loader   4

Compute loss and scores on test set:
step  % :  0.0  i/I =  0 / 4
Epoch: 15 	 step: 0.0000 
Epoch: 15 	 test_loss: 70.3152 and 5.87 fps
DET_AUROC: 	 last: 96.99 	 max: 99.64 	 epoch_max: 0
DET_AUROC  0.9699036918138041
 SEG_AUROC   0.9888030910875402
SEG_AUROC: 	 last: 98.88 	 max: 98.99 	 epoch_max: 2
Len train loader =  8
Epoch: 16 	 sub-epoch: 0.0000 
step  % :  0.0  i/I =  0 / 8
